(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59537,       1402]
NotebookOptionsPosition[     58250,       1376]
NotebookOutlinePosition[     58676,       1393]
CellTagsIndexPosition[     58633,       1390]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"DONE", " ", "ABCD", " ", "matrix", " ", "of", " ", "TLs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Z", " ", "characteristic", " ", "impedance"}], ";", " ", 
     RowBox[{"k", " ", "wavenumber"}], ";", " ", 
     RowBox[{"l", " ", "length"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ABCDTL", "[", 
       RowBox[{"Z_", ",", "\[Gamma]_", ",", "l_"}], "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cosh", "[", 
           RowBox[{"\[Gamma]", " ", "l"}], "]"}], ",", 
          RowBox[{"Z", " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"\[Gamma]", " ", "l"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox["1", "Z"], " ", 
           RowBox[{"Sinh", "[", 
            RowBox[{"\[Gamma]", " ", "l"}], "]"}]}], ",", 
          RowBox[{"Cosh", "[", 
           RowBox[{"\[Gamma]", " ", "l"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]"}]}],
  FontSize->18]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQLfm5e6P3qteOCq1vt4BoD6OynSCaf9aswyD6wZVt
J0D0zPPfwPSv37bnQHSJK+8lEM33T9TfF0ivmSQNpjP0fAyvgMSXN5mA6Btt
1u7Sq1871m276QGiX/16yl8EpM2+/hUE0Vp9UmIgWsVHVgJEc9stVgLRc+9Z
q4Loc9m/9UD0hR9hFiB6duePtjIgvWgl80QQPe1su2cFkLa9OR9M9xlYKaQk
v3FM2JyqBKJlaq+qgWi+ZgltEK1brfHpZcobxxz9QDDtu+mg4ysgfazmPpje
arbQH0Sv+CAZCKLT5mWHgegZLQciQDTLp7m7m+69cUwMbtwLoq+YKV1oA9I+
orEXQbRe8a2gdiD9s/wdmAYAyo+79A==
  "],ExpressionUUID->"b3c77ff3-8f48-4d9a-93a0-fd639b685f45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"DONE", " ", "Product", " ", "of", " ", "matrices", " ", 
    RowBox[{"TL", "[", 
     RowBox[{"Z", ",", "\[Gamma]", ",", "l"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Z", ",", "\[Gamma]", ",", 
    RowBox[{"d", " ", "are", " ", "given", " ", "as", " ", "vectors"}]}], 
   "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"prodTL", "[", 
      RowBox[{"Z_", ",", "\[Gamma]_", ",", "l_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T", ",", "i", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "=", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "Z", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"T", "=", 
           RowBox[{"T", ".", 
            RowBox[{"ABCDTL", "[", 
             RowBox[{
              RowBox[{"Z", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"l", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "T"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.810206548650735*^9, 3.8102065770431004`*^9}, {
   3.8102067277245245`*^9, 3.810206755423479*^9}, {3.810206788576926*^9, 
   3.8102067960778694`*^9}, {3.810208957511744*^9, 3.810208960496743*^9}, {
   3.8102091687902727`*^9, 3.8102091706752005`*^9}, 3.811003561005247*^9, {
   3.8110049488204737`*^9, 3.811004950357867*^9}, {3.874764428457333*^9, 
   3.874764429172611*^9}, {3.874765459379637*^9, 3.874765459739929*^9}, 
   3.8747655237244253`*^9},
 FontSize->18,ExpressionUUID->"f4e80651-e929-4df1-91d8-77488f2cadc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Functions", " ", "to", " ", "unfold", " ", "imaginary", " ", "part", " ", 
    "of", " ", "propagation", " ", "constant"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Generating", " ", "points", " ", "around", " ", "the", " ", "maxima", " ",
     "of", " ", 
    FractionBox[
     RowBox[{"a", "+", "d"}], "2"]}], "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"intPoints", "[", 
      RowBox[{"range_", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "l", ",", "in", ",", "cen", ",", "fin", ",", "cen1", ",", "ps", ",", 
         "pss"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", "range", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"in", "=", 
         RowBox[{"range", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cen", "=", 
         RowBox[{"range", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fin", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"l", "\[Equal]", "3"}], ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "cen"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cen1", "=", 
         RowBox[{"cen", "+", "0.001"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ps", "=", 
         RowBox[{"logXcPoints", "[", 
          RowBox[{"cen1", ",", "in", ",", "cen", ",", "n"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pss", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"ps", "-", "cen"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pss", "=", 
         RowBox[{"ps", "\[Union]", 
          RowBox[{"cen", "+", "pss"}], "\[Union]", 
          RowBox[{"{", "fin", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Select", "[", 
         RowBox[{"pss", ",", 
          RowBox[{
           RowBox[{"#", "\[LessEqual]", "fin"}], "&"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Determining", " ", "stopbands", " ", "and", " ", "maxima", " ", "of", 
     " ", 
     FractionBox[
      RowBox[{"a", "+", "d"}], "2"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Needs", "[", "\"\<Ersek`RootSearch`\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     StyleBox[
      RowBox[{"$MinPrecision", "::", "precset"}], "MessageName"], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pmcg", "[", 
      RowBox[{"abcd_", ",", "fmin_", ",", "fmax_", ",", 
       RowBox[{"st_", ":", "0.25"}], ",", 
       RowBox[{"num_", ":", "20"}]}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ad2", ",", "stops", ",", "stops1", ",", "max", ",", "f", ",", 
         "points", ",", "i", ",", "fi", ",", "adint", ",", "points1", ",", 
         "int", ",", "ceros", ",", "n", ",", "last", ",", "ad2m", ",", 
         "partes", ",", "gaps", ",", "gaps1", ",", "f1", ",", "f2", ",", 
         "n1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ad2", "[", "f_", "]"}], ":=", 
         RowBox[{"Re", "[", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"abcd", "[", "f", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"abcd", "[", "f", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"ad2m", "=", 
         RowBox[{"ad2", "[", "fmax", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"step", "[", 
          RowBox[{"fmin", ",", "fmax", ",", "st"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"points", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fi", "=", 
              RowBox[{"fmin", "+", 
               RowBox[{"i", " ", "st"}]}]}], ";", 
             RowBox[{"{", 
              RowBox[{"fi", ",", 
               RowBox[{"ad2", "[", "fi", "]"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], "\[Union]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"fmax", ",", "ad2m"}], "}"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"points1", "=", "points"}], ";", "\[IndentingNewLine]", 
        RowBox[{"int", "=", 
         RowBox[{"Interpolation", "[", "points", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ceros", "=", 
         RowBox[{"f", "/.", 
          RowBox[{"RootSearch", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"int", "[", "f", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}]}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"max", "=", 
         RowBox[{"f", "/.", 
          RowBox[{"RootSearch", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"int", "'"}], "[", "f", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "fmin", ",", "fmax"}], "}"}]}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"last", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"max", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ">", 
            RowBox[{"ceros", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", "fmax", "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ad2m", "\[GreaterEqual]", "1"}], ",", 
             RowBox[{"{", "fmax", "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"partes", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"ceros", "\[Union]", "max", "\[Union]", "last"}], ",", "3",
            ",", "2", ",", "1", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"partes", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"partes", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"n1", "=", 
         RowBox[{"Length", "[", "partes", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gaps1", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n1"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"points", "=", 
            RowBox[{"intPoints", "[", 
             RowBox[{
              RowBox[{"partes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "num"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"f1", "=", 
            RowBox[{"points", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", 
           RowBox[{"f2", "=", 
            RowBox[{"points", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
           RowBox[{"n", "=", 
            RowBox[{"Length", "[", "points", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"points", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fi", "=", 
                RowBox[{"points", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", 
               RowBox[{"{", 
                RowBox[{"fi", ",", 
                 RowBox[{"ad2", "[", "fi", "]"}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"points1", "=", 
            RowBox[{"points1", "\[Union]", "points"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"int", "=", 
            RowBox[{"Interpolation", "[", "points", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"gaps", "=", 
            RowBox[{"f", "/.", 
             RowBox[{"RootSearch", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"int", "[", "f", "]"}], "]"}], "\[Equal]", "1"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"f", ",", "f1", ",", "f2"}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"gaps1", "=", 
            RowBox[{
             RowBox[{"{", "gaps", "}"}], "\[Union]", "gaps1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"gaps1", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"gaps1", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], 
             "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"points1", ",", "max", ",", "ceros", ",", "gaps1"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Determining", " ", "where", " ", "f", " ", "is", " ", "respect", " ", 
     "to", " ", "maxima", " ", "and", " ", "ceros", " ", "of", " ", 
     FractionBox[
      RowBox[{"a", "+", "d"}], "2"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "done", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fpos", "[", 
      RowBox[{"max_", ",", "ceros_", ",", "f_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f1", ",", "i", ",", "j", ",", "p"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "ceros", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"f1", "=", 
            RowBox[{"ceros", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", "=", "i"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"f", "\[LessEqual]", "f1"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"f", ">", "f1"}], ",", 
          RowBox[{"j", "=", 
           RowBox[{"j", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"p", "=", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"j", "-", "1"}]}], ",", 
             RowBox[{"i", "\[LessEqual]", "j"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", ">", 
                 RowBox[{"Length", "[", "max", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p", "=", "i"}], ")"}], "&&", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"f1", "=", 
               RowBox[{"max", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"p", "=", "i"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"f", "\[LessEqual]", "f1"}], ",", 
                RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"p", ",", "j"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.814026345170869*^9, 3.814026377642269*^9}, {
   3.814027018460054*^9, 3.8140270728235335`*^9}, {3.814027375108287*^9, 
   3.8140273851438427`*^9}, {3.8140274173052254`*^9, 
   3.8140274451466475`*^9}, {3.814027923681633*^9, 3.8140279702565217`*^9}, {
   3.81402800494781*^9, 3.8140280078424845`*^9}, {3.8140282232666616`*^9, 
   3.8140283274999313`*^9}, {3.8140283971417136`*^9, 3.814028409076322*^9}, {
   3.814028442274271*^9, 3.814028521141595*^9}, {3.814028568789767*^9, 
   3.8140285712194257`*^9}, {3.814028640220085*^9, 3.81402870846299*^9}, {
   3.814029391550321*^9, 3.8140293997215157`*^9}, {3.8140296474565964`*^9, 
   3.814029699486859*^9}, 3.814029767472603*^9, 3.8140298038876085`*^9, {
   3.814084960965706*^9, 3.814085002245412*^9}, {3.814095046859595*^9, 
   3.814095048348615*^9}, {3.8140950828324833`*^9, 3.81409515589022*^9}, {
   3.814520735725974*^9, 3.8145207669203057`*^9}, {3.8145209291719303`*^9, 
   3.814520966001912*^9}, 3.814530859775857*^9, {3.8145315398407383`*^9, 
   3.814531540371519*^9}, 3.8145316296885834`*^9, {3.8145331625346026`*^9, 
   3.8145332006906013`*^9}, 3.814537960752905*^9, {3.814544424594855*^9, 
   3.814544424689931*^9}, {3.814546893145113*^9, 3.814546897003631*^9}, {
   3.814567680729929*^9, 3.8145677254685535`*^9}, {3.8150771460589476`*^9, 
   3.815077146217901*^9}, {3.815230863214124*^9, 3.815230909516346*^9}, {
   3.8152309449987574`*^9, 3.815230955547511*^9}, {3.8152323809119473`*^9, 
   3.8152323947050323`*^9}, {3.815232526227704*^9, 3.8152325373205633`*^9}, {
   3.815232594972699*^9, 3.815232621076793*^9}, {3.815233799360328*^9, 
   3.8152337998384604`*^9}, {3.8152338428892317`*^9, 
   3.8152338458667893`*^9}, {3.8152345972028213`*^9, 
   3.8152346266659455`*^9}, {3.8152346764029517`*^9, 3.815234707096247*^9}, {
   3.815235273409009*^9, 3.815235279745818*^9}, {3.8152353612668996`*^9, 
   3.8152353776181626`*^9}, {3.815236793604357*^9, 3.8152368502214594`*^9}, {
   3.8152369198715696`*^9, 3.8152369216486206`*^9}, {3.815236957581441*^9, 
   3.8152369582915115`*^9}, {3.8152371826219034`*^9, 3.815237193866588*^9}, {
   3.815237584155122*^9, 3.81523758474239*^9}, {3.815404434190793*^9, 
   3.8154044445889807`*^9}, {3.815404527795426*^9, 3.8154045625953813`*^9}, {
   3.8154050278792996`*^9, 3.815405033817438*^9}, {3.8154050646738777`*^9, 
   3.8154050928325605`*^9}, {3.815405137658498*^9, 3.8154051402754984`*^9}, 
   3.828010246244465*^9, 3.8280103981026163`*^9, {3.82801060104647*^9, 
   3.8280106017299953`*^9}, {3.8752834992851753`*^9, 3.875283499533351*^9}, {
   3.875284357290559*^9, 3.875284375517517*^9}},
 FontSize->18,ExpressionUUID->"9a12751b-a73a-43f1-990d-619b7ab9f0a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Propagation", " ", "constant", " ", "and", " ", "Bloch", " ", 
    "impedance"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "propagation", " ", "constant", " ", "is", " ", "obtained", 
    " ", "through", " ", 
    RowBox[{"ArcCosh", "[", 
     FractionBox[
      RowBox[{"A", "+", "D"}], "2"], "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ZB", " ", "is", " ", "selected", " ", "such", " ", "that", " ", 
     RowBox[{"Re", "[", "ZB", "]"}]}], "\[GreaterEqual]", "0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Propagation", " ", "constant", " ", "calculated", " ", "as", " ", 
    "\[Gamma]d"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]dzb", "[", 
     RowBox[{"ABCD_", ",", "max_", ",", "ceros_", ",", "f_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "A", ",", "B", ",", "C", ",", "D", ",", "ADs2", ",", "ADm", ",", "zb1",
         ",", "zb2", ",", "p", ",", "gd", ",", "igd", ",", "zb", ",", "z", 
        ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{"ABCD", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"B", "=", 
        RowBox[{"ABCD", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", "=", 
        RowBox[{"ABCD", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"D", "=", 
        RowBox[{"ABCD", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ADs2", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"A", "+", "D"}], ")"}], "2"], "-", "4"}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ADm", "=", 
        RowBox[{"A", "-", "D"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"gd1", "=", 
          RowBox[{"Log", "[", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"AD", "+", "ADs2"}], ")"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"gd2", "=", 
          RowBox[{"Log", "[", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"AD", "-", "ADs2"}], ")"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"gd", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"ArcCosh", "[", 
          FractionBox[
           RowBox[{"A", "+", "D"}], "2"], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zb1", "=", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", "B"}], 
          RowBox[{"ADm", "-", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"zb2", "=", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", "B"}], 
          RowBox[{"ADm", "+", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zb", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "zb1", "]"}], "\[GreaterEqual]", "0"}], ",", 
          "zb1", ",", "zb2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "j"}], "}"}], "=", 
        RowBox[{"fpos", "[", 
         RowBox[{"max", ",", "ceros", ",", "f"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"z", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", "p", "]"}], ",", 
          RowBox[{"j", "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"j", "-", "1"}], ",", "2"}], "]"}]}], ",", 
          RowBox[{"j", "-", 
           RowBox[{"Mod", "[", 
            RowBox[{"j", ",", "2"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"igd", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"z", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"z", " ", "\[Pi]"}], "-", 
           RowBox[{"Im", "[", "gd", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Im", "[", "gd", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"z", "-", "1"}], ")"}], "\[Pi]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gd", "=", 
        RowBox[{
         RowBox[{"Re", "[", "gd", "]"}], "+", 
         RowBox[{"\[ImaginaryJ]", " ", "igd"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"gd", ",", "zb"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.811503209408585*^9, 3.811503251574188*^9}, {
   3.811503633433984*^9, 3.8115036805718746`*^9}, {3.811504081660706*^9, 
   3.811504103782629*^9}, {3.811504511079488*^9, 3.8115045280971375`*^9}, {
   3.8115045765161314`*^9, 3.8115045820338793`*^9}, 3.8115048457066326`*^9, {
   3.8115048834173737`*^9, 3.811504945268877*^9}, {3.8115062074151063`*^9, 
   3.811506426092263*^9}, {3.8115069234874463`*^9, 3.811506932174059*^9}, {
   3.8115069659676313`*^9, 3.8115069664383717`*^9}, {3.81150699754589*^9, 
   3.8115070042540665`*^9}, {3.8115080123872757`*^9, 
   3.8115080167446327`*^9}, {3.8115080837172136`*^9, 
   3.8115080843809767`*^9}, {3.8115098231146264`*^9, 3.811509828843528*^9}, {
   3.8115101228417687`*^9, 3.8115101789392724`*^9}, {3.8115102234756823`*^9, 
   3.8115102498372746`*^9}, {3.81151030273798*^9, 3.8115103082451057`*^9}, {
   3.8115103733699756`*^9, 3.811510374216688*^9}, {3.811540511949819*^9, 
   3.8115405125825157`*^9}, {3.813268084712036*^9, 3.813268109620671*^9}, {
   3.813268141721878*^9, 3.813268243889822*^9}, {3.813319714122054*^9, 
   3.8133197141759105`*^9}, {3.8133201971490755`*^9, 
   3.8133202020431843`*^9}, {3.8133203514411077`*^9, 3.813320353396963*^9}, {
   3.813323912834712*^9, 3.8133239152931333`*^9}, {3.8139266356376867`*^9, 
   3.813926644361171*^9}, {3.813926695786966*^9, 3.8139267275341096`*^9}, {
   3.814086267630847*^9, 3.8140863195091352`*^9}, {3.814091520891857*^9, 
   3.8140917160427938`*^9}, {3.8140917503163877`*^9, 
   3.8140917678938913`*^9}, {3.814091871512409*^9, 3.814091880551241*^9}, {
   3.814091917160922*^9, 3.8140919586894464`*^9}, {3.8140920985602937`*^9, 
   3.814092158314247*^9}, {3.8140924826888285`*^9, 3.8140925032969604`*^9}, {
   3.8140931624290147`*^9, 3.814093220560622*^9}, 3.814093371258652*^9, {
   3.814093997487612*^9, 3.8140940361947536`*^9}, {3.8140945018868876`*^9, 
   3.814094614065378*^9}, {3.814094645180798*^9, 3.814094775941347*^9}, {
   3.814095042693705*^9, 3.8140950437329245`*^9}, {3.814095078306583*^9, 
   3.8140951182785435`*^9}, {3.814106621664407*^9, 3.8141067392550116`*^9}, {
   3.8146064889971704`*^9, 3.814606507664242*^9}, {3.8146111139869103`*^9, 
   3.8146111321856604`*^9}, {3.8146148882149553`*^9, 
   3.8146148947943554`*^9}, {3.81461506544759*^9, 3.8146150708232403`*^9}, {
   3.814615141529586*^9, 3.814615202310014*^9}, {3.8146153847037067`*^9, 
   3.8146153963635187`*^9}, {3.8146155717983274`*^9, 3.814615575169312*^9}, {
   3.8146157175251884`*^9, 3.8146157307498474`*^9}, {3.8146158693791976`*^9, 
   3.8146158759745617`*^9}, {3.8149853398770237`*^9, 3.814985346820801*^9}, {
   3.815074978191182*^9, 3.8150749785251765`*^9}, {3.8150768702448993`*^9, 
   3.815076871972957*^9}, {3.8150772338156853`*^9, 3.8150772351422205`*^9}, {
   3.815168682486555*^9, 3.8151686862379584`*^9}, {3.8151689088902636`*^9, 
   3.81516891247694*^9}, {3.8151690140554295`*^9, 3.8151690185922904`*^9}, {
   3.8151691271637006`*^9, 3.8151691319203234`*^9}, {3.8151694233560653`*^9, 
   3.815169425598068*^9}, {3.8151694744871297`*^9, 3.8151694780242915`*^9}, {
   3.815206406298904*^9, 3.8152064103838525`*^9}, {3.815208774812211*^9, 
   3.815208779112709*^9}, {3.8152093944558372`*^9, 3.8152094021582336`*^9}, {
   3.8152097994520755`*^9, 3.8152099084940996`*^9}, {3.815209964095286*^9, 
   3.8152099870581293`*^9}, {3.815210165400741*^9, 3.815210232205592*^9}, {
   3.815210376045452*^9, 3.8152104123811626`*^9}, {3.815210458104557*^9, 
   3.815210497460602*^9}, {3.815229428115562*^9, 3.815229454128119*^9}, {
   3.8152294946431494`*^9, 3.815229519199617*^9}, {3.815237279313506*^9, 
   3.8152373082281923`*^9}, {3.8152373577147856`*^9, 
   3.8152373683596478`*^9}, {3.815237490505726*^9, 3.815237522169793*^9}, {
   3.8153175888468294`*^9, 3.815317599644503*^9}, {3.81531763772219*^9, 
   3.815317706773274*^9}, {3.8154051625090284`*^9, 3.8154051666459913`*^9}, {
   3.815407156869858*^9, 3.8154071963751936`*^9}, 3.815408446238865*^9, {
   3.8154085132865596`*^9, 3.8154085162985044`*^9}, {3.8154085954846992`*^9, 
   3.815408597543166*^9}, {3.815408658094223*^9, 3.8154086590995216`*^9}, {
   3.8157510586361413`*^9, 3.815751065927638*^9}, {3.815751374518259*^9, 
   3.8157513781096544`*^9}, {3.8314724586910195`*^9, 3.831472463398429*^9}, {
   3.875268026192987*^9, 3.8752680367777443`*^9}},
 FontSize->18,ExpressionUUID->"221d47f6-e111-43a9-b9f0-1ac9466c2440"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Propagation", " ", "constant", " ", "and", " ", "Bloch", " ", 
    "impedance"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "propagation", " ", "constant", " ", "is", " ", "obtained", 
    " ", "through", " ", 
    RowBox[{"ArcCosh", "[", 
     FractionBox[
      RowBox[{"A", "+", "D"}], "2"], "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ZB", " ", "is", " ", "selected", " ", "such", " ", "that", " ", 
     RowBox[{"Re", "[", "ZB", "]"}]}], "\[GreaterEqual]", "0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Propagation", " ", "constant", " ", "calculated", " ", "as", " ", 
    "\[Gamma]d"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", "function", " ", "sets", " ", 
     RowBox[{"Im", "[", "\[Gamma]", "]"}]}], "=", 
    RowBox[{"0", " ", "inside", " ", "the", " ", "gaps"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]dzb0", "[", 
      RowBox[{"ABCD_", ",", "max_", ",", "ceros_", ",", "gaps_", ",", "f_"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "A", ",", "B", ",", "C", ",", "D", ",", "ADs2", ",", "ADm", ",", 
         "zb1", ",", "zb2", ",", "pp", ",", "gd", ",", "zb", ",", "z", ",", 
         "jj", ",", "igd"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"C", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADs2", "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"A", "+", "D"}], ")"}], "2"], "-", "4"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADm", "=", 
         RowBox[{"A", "-", "D"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gd", "=", 
         RowBox[{"ArcCosh", "[", 
          FractionBox[
           RowBox[{"A", "+", "D"}], "2"], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zb1", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "-", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"zb2", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "+", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zb", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Re", "[", "zb1", "]"}], "\[GreaterEqual]", "0"}], ",", 
           "zb1", ",", "zb2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pp", ",", "jj"}], "}"}], "=", 
         RowBox[{"fpos", "[", 
          RowBox[{"max", ",", "ceros", ",", "f"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", "pp", "]"}], ",", 
           RowBox[{"jj", "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"jj", "-", "1"}], ",", "2"}], "]"}]}], ",", 
           RowBox[{"jj", "-", 
            RowBox[{"Mod", "[", 
             RowBox[{"jj", ",", "2"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"igd", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"z", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"z", " ", "\[Pi]"}], "-", 
            RowBox[{"Im", "[", "gd", "]"}]}], ",", 
           RowBox[{
            RowBox[{"Im", "[", "gd", "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z", "-", "1"}], ")"}], "\[Pi]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"jj", ">", "1"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"gaps", "[", 
               RowBox[{"[", 
                RowBox[{"jj", "-", "1"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "f", 
             "\[LessEqual]", 
             RowBox[{
              RowBox[{"gaps", "[", 
               RowBox[{"[", 
                RowBox[{"jj", "-", "1"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"igd", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "gd", "]"}], "+", 
           RowBox[{"\[ImaginaryJ]", " ", "igd"}]}], ",", "zb"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "done", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]dzb0", "[", 
      RowBox[{"ABCD_", ",", "max_", ",", "ceros_", ",", "f_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "A", ",", "B", ",", "C", ",", "D", ",", "ADs2", ",", "ADm", ",", 
         "zb1", ",", "zb2", ",", "p", ",", "gd", ",", "igd", ",", "zb", ",", 
         "z", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"C", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADs2", "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"A", "+", "D"}], ")"}], "2"], "-", "4"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADm", "=", 
         RowBox[{"A", "-", "D"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"gd1", "=", 
           RowBox[{"Log", "[", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"AD", "+", "ADs2"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gd2", "=", 
           RowBox[{"Log", "[", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"AD", "-", "ADs2"}], ")"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"gd", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"ArcCosh", "[", 
           FractionBox[
            RowBox[{"A", "+", "D"}], "2"], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"zb1", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "-", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"zb2", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "+", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zb", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Re", "[", "zb1", "]"}], "\[GreaterEqual]", "0"}], ",", 
           "zb1", ",", "zb2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p", ",", "j"}], "}"}], "=", 
         RowBox[{"fpos", "[", 
          RowBox[{"max", ",", "ceros", ",", "f"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", "p", "]"}], ",", 
           RowBox[{"j", "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"j", "-", "1"}], ",", "2"}], "]"}]}], ",", 
           RowBox[{"j", "-", 
            RowBox[{"Mod", "[", 
             RowBox[{"j", ",", "2"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"igd", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"z", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"z", " ", "\[Pi]"}], "-", 
            RowBox[{"Im", "[", "gd", "]"}]}], ",", 
           RowBox[{
            RowBox[{"Im", "[", "gd", "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z", "-", "1"}], ")"}], "\[Pi]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"igd", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"igd", ",", "\[Pi]"}], "]"}], "\[Equal]", "0"}], ",", 
           "0", ",", "igd"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"gd", "=", 
         RowBox[{
          RowBox[{"Re", "[", "gd", "]"}], "+", 
          RowBox[{"\[ImaginaryJ]", " ", "igd"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"gd", ",", "zb"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Propagation", " ", "constant", " ", "and", " ", "Bloch", " ", 
     "impedance"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "propagation", " ", "constant", " ", "is", " ", "obtained", 
     " ", "through", " ", 
     RowBox[{"ArcCosh", "[", 
      FractionBox[
       RowBox[{"A", "+", "D"}], "2"], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ZB", " ", "is", " ", "selected", " ", "such", " ", "that", " ", 
      RowBox[{"Re", "[", "ZB", "]"}]}], "\[GreaterEqual]", "0"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Propagation", " ", "constant", " ", "calculated", " ", "as", " ", 
     "\[Gamma]d"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", "function", " ", "sets", " ", 
      RowBox[{"Im", "[", "\[Gamma]", "]"}]}], "=", 
     RowBox[{
     "0", " ", "or", " ", "\[Pi]", " ", "inside", " ", "the", " ", "gaps"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "DONE", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]dzb10", "[", 
      RowBox[{"ABCD_", ",", "max_", ",", "ceros_", ",", "gaps_", ",", "f_"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "A", ",", "B", ",", "C", ",", "D", ",", "ADs2", ",", "ADm", ",", 
         "zb1", ",", "zb2", ",", "pp", ",", "gd", ",", "zb", ",", "z", ",", 
         "jj", ",", "igd"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"C", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADs2", "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"A", "+", "D"}], ")"}], "2"], "-", "4"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADm", "=", 
         RowBox[{"A", "-", "D"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"gd", "=", 
         RowBox[{"ArcCosh", "[", 
          FractionBox[
           RowBox[{"A", "+", "D"}], "2"], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zb1", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "-", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"zb2", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "+", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zb", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Re", "[", "zb1", "]"}], "\[GreaterEqual]", "0"}], ",", 
           "zb1", ",", "zb2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pp", ",", "jj"}], "}"}], "=", 
         RowBox[{"fpos", "[", 
          RowBox[{"max", ",", "ceros", ",", "f"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", "pp", "]"}], ",", 
           RowBox[{"jj", "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"jj", "-", "1"}], ",", "2"}], "]"}]}], ",", 
           RowBox[{"jj", "-", 
            RowBox[{"Mod", "[", 
             RowBox[{"jj", ",", "2"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"igd", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"jj", ">", "1"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"gaps", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "f", 
              "\[LessEqual]", 
              RowBox[{
               RowBox[{"gaps", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", "-", "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"Im", "[", "gd", "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"z", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"z", " ", "\[Pi]"}], "-", 
              RowBox[{"Im", "[", "gd", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Im", "[", "gd", "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", "-", "1"}], ")"}], "\[Pi]"}]}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "gd", "]"}], "+", 
           RowBox[{"\[ImaginaryJ]", " ", "igd"}]}], ",", "zb"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Propagation", " ", "constant", " ", "and", " ", "Bloch", " ", 
     "impedance"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "propagation", " ", "constant", " ", "is", " ", "obtained", 
     " ", "through", " ", 
     RowBox[{"ArcCosh", "[", 
      FractionBox[
       RowBox[{"A", "+", "D"}], "2"], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ZB", " ", "is", " ", "selected", " ", "such", " ", "that", " ", 
      RowBox[{"Re", "[", "ZB", "]"}]}], "\[GreaterEqual]", "0"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Propagation", " ", "constant", " ", "calculated", " ", "as", " ", 
     "\[Gamma]d"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"No", " ", "unfolding", " ", "of", " ", "\[Gamma]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Done", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]dzbn", "[", 
      RowBox[{"ABCD_", ",", "max_", ",", "f_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "A", ",", "B", ",", "C", ",", "D", ",", "ADs2", ",", "ADm", ",", 
         "zb1", ",", "zb2", ",", "p", ",", "gd", ",", "igd", ",", "zb", ",", 
         "z", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"C", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "=", 
         RowBox[{"ABCD", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADs2", "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"A", "+", "D"}], ")"}], "2"], "-", "4"}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ADm", "=", 
         RowBox[{"A", "-", "D"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"gd1", "=", 
           RowBox[{"Log", "[", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"AD", "+", "ADs2"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gd2", "=", 
           RowBox[{"Log", "[", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"AD", "-", "ADs2"}], ")"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"gd", "=", 
         RowBox[{"ArcCosh", "[", 
          FractionBox[
           RowBox[{"A", "+", "D"}], "2"], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zb1", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "-", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"zb2", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", "B"}], 
           RowBox[{"ADm", "+", "ADs2"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zb", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Re", "[", "zb1", "]"}], "\[GreaterEqual]", "0"}], ",", 
           "zb1", ",", "zb2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"gd", ",", "zb"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.811503209408585*^9, 3.811503251574188*^9}, {
   3.811503633433984*^9, 3.8115036805718746`*^9}, {3.811504081660706*^9, 
   3.811504103782629*^9}, {3.811504511079488*^9, 3.8115045280971375`*^9}, {
   3.8115045765161314`*^9, 3.8115045820338793`*^9}, 3.8115048457066326`*^9, {
   3.8115048834173737`*^9, 3.811504945268877*^9}, {3.8115062074151063`*^9, 
   3.811506426092263*^9}, {3.8115069234874463`*^9, 3.811506932174059*^9}, {
   3.8115069659676313`*^9, 3.8115069664383717`*^9}, {3.81150699754589*^9, 
   3.8115070042540665`*^9}, {3.8115080123872757`*^9, 
   3.8115080167446327`*^9}, {3.8115080837172136`*^9, 
   3.8115080843809767`*^9}, {3.8115098231146264`*^9, 3.811509828843528*^9}, {
   3.8115101228417687`*^9, 3.8115101789392724`*^9}, {3.8115102234756823`*^9, 
   3.8115102498372746`*^9}, {3.81151030273798*^9, 3.8115103082451057`*^9}, {
   3.8115103733699756`*^9, 3.811510374216688*^9}, {3.811540511949819*^9, 
   3.8115405125825157`*^9}, {3.813268084712036*^9, 3.813268109620671*^9}, {
   3.813268141721878*^9, 3.813268243889822*^9}, {3.813319714122054*^9, 
   3.8133197141759105`*^9}, {3.8133201971490755`*^9, 
   3.8133202020431843`*^9}, {3.8133203514411077`*^9, 3.813320353396963*^9}, {
   3.813323912834712*^9, 3.8133239152931333`*^9}, {3.8139266356376867`*^9, 
   3.813926644361171*^9}, {3.813926695786966*^9, 3.8139267275341096`*^9}, {
   3.814086267630847*^9, 3.8140863195091352`*^9}, {3.814091520891857*^9, 
   3.8140917160427938`*^9}, {3.8140917503163877`*^9, 
   3.8140917678938913`*^9}, {3.814091871512409*^9, 3.814091880551241*^9}, {
   3.814091917160922*^9, 3.8140919586894464`*^9}, {3.8140920985602937`*^9, 
   3.814092158314247*^9}, {3.8140924826888285`*^9, 3.8140925032969604`*^9}, {
   3.8140931624290147`*^9, 3.814093220560622*^9}, 3.814093371258652*^9, {
   3.814093997487612*^9, 3.8140940361947536`*^9}, {3.8140945018868876`*^9, 
   3.814094614065378*^9}, {3.814094645180798*^9, 3.814094775941347*^9}, {
   3.814095042693705*^9, 3.8140950437329245`*^9}, {3.814095078306583*^9, 
   3.8140951182785435`*^9}, {3.814106621664407*^9, 3.8141067392550116`*^9}, {
   3.8146064889971704`*^9, 3.814606507664242*^9}, {3.8146111139869103`*^9, 
   3.8146111321856604`*^9}, {3.8146148882149553`*^9, 
   3.8146148947943554`*^9}, {3.81461506544759*^9, 3.8146150708232403`*^9}, {
   3.814615141529586*^9, 3.814615202310014*^9}, {3.8146153847037067`*^9, 
   3.8146153963635187`*^9}, {3.8146155717983274`*^9, 3.814615575169312*^9}, {
   3.8146157175251884`*^9, 3.8146157307498474`*^9}, {3.8146158693791976`*^9, 
   3.8146158759745617`*^9}, {3.8149853398770237`*^9, 3.814985346820801*^9}, {
   3.815074978191182*^9, 3.8150749785251765`*^9}, {3.8150768702448993`*^9, 
   3.815076871972957*^9}, {3.8150772338156853`*^9, 3.8150772351422205`*^9}, {
   3.815168682486555*^9, 3.8151686862379584`*^9}, {3.8151689088902636`*^9, 
   3.81516891247694*^9}, {3.8151690140554295`*^9, 3.8151690185922904`*^9}, {
   3.8151691271637006`*^9, 3.8151691319203234`*^9}, {3.8151694233560653`*^9, 
   3.815169425598068*^9}, {3.8151694744871297`*^9, 3.8151694780242915`*^9}, {
   3.815206406298904*^9, 3.8152064103838525`*^9}, {3.815208774812211*^9, 
   3.815208779112709*^9}, {3.8152093944558372`*^9, 3.8152094021582336`*^9}, {
   3.8152097994520755`*^9, 3.8152099084940996`*^9}, {3.815209964095286*^9, 
   3.8152099870581293`*^9}, {3.815210165400741*^9, 3.815210232205592*^9}, {
   3.815210376045452*^9, 3.8152104123811626`*^9}, {3.815210458104557*^9, 
   3.815210497460602*^9}, {3.815229428115562*^9, 3.815229454128119*^9}, {
   3.8152294946431494`*^9, 3.815229519199617*^9}, {3.815237279313506*^9, 
   3.8152373082281923`*^9}, {3.8152373577147856`*^9, 
   3.8152373683596478`*^9}, {3.815237490505726*^9, 3.815237522169793*^9}, {
   3.8153175888468294`*^9, 3.815317599644503*^9}, {3.81531763772219*^9, 
   3.815317706773274*^9}, {3.815324841367487*^9, 3.815324912715681*^9}, {
   3.8154051878482556`*^9, 3.8154051907375255`*^9}, {3.8154052768122997`*^9, 
   3.815405360177709*^9}, {3.8154065514662485`*^9, 3.8154066098161507`*^9}, {
   3.815406730667905*^9, 3.815406782332715*^9}, {3.8154069033818693`*^9, 
   3.8154069070430784`*^9}, 3.815407089616746*^9, {3.8154086888459578`*^9, 
   3.815408695967938*^9}, {3.8154087395244308`*^9, 3.815408743670317*^9}, {
   3.815409009836403*^9, 3.8154090175756955`*^9}, {3.815409074998139*^9, 
   3.8154090842882576`*^9}, {3.8154095216594906`*^9, 
   3.8154095425296683`*^9}, {3.8154096029071765`*^9, 
   3.8154096272570477`*^9}, {3.81575265754451*^9, 3.81575266290617*^9}, {
   3.8157536327073956`*^9, 3.8157536869211235`*^9}, 3.815753738828617*^9, {
   3.815753775228614*^9, 3.815753835721596*^9}, {3.815753942963597*^9, 
   3.815753954106096*^9}, {3.815754089834238*^9, 3.8157541285732746`*^9}, {
   3.8280094371548433`*^9, 3.828009453808878*^9}, {3.8280096337065883`*^9, 
   3.828009681417489*^9}, {3.8280144949964743`*^9, 3.8280145422522993`*^9}, {
   3.8280147570518064`*^9, 3.828014765856007*^9}, 3.8280175473557253`*^9, {
   3.8281090255234146`*^9, 3.8281090643611364`*^9}, {3.828109255153129*^9, 
   3.8281092567488613`*^9}, {3.831724979033879*^9, 3.831724984374595*^9}, {
   3.8317254327631216`*^9, 3.8317254347498064`*^9}, 3.8317260963724875`*^9, {
   3.875259974299699*^9, 3.875259987289056*^9}, {3.8752607078550997`*^9, 
   3.8752607146299343`*^9}, {3.875265375392878*^9, 3.875265387914299*^9}, {
   3.875265794152897*^9, 3.875265813781069*^9}},
 FontSize->18,ExpressionUUID->"09e413ef-8fab-4ab4-937a-713ce585a74f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "DONE", " ", "Transmission", " ", "of", " ", "n", " ", "identical", " ", 
    "cells"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S21Ncell", "[", 
     RowBox[{
     "n_", ",", "Zequ1_", ",", "Zequ2_", ",", "\[Gamma]equ_", ",", "d_", ",", 
      "Zo_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"d", "*", "n", "*", "\[Gamma]equ"}], ")"}]}], "*", 
       RowBox[{"(", 
        RowBox[{"Zequ1", "-", "Zequ2"}], ")"}], "*", "Zo"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"2", "*", "d", "*", "n", "*", "\[Gamma]equ"}], ")"}]}]}], 
         ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"Zequ1", "-", "Zequ2"}], ")"}], "*", "Zo"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"2", "*", "d", "*", "n", "*", "\[Gamma]equ"}], ")"}]}]}], 
         ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Zequ1", "*", "Zequ2"}], "-", 
          RowBox[{"Zo", "^", "2"}]}], ")"}]}]}], ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.874765308097908*^9, 3.874765311587386*^9}, {
  3.874765446874116*^9, 3.874765449941387*^9}},
 FontSize->18,ExpressionUUID->"5006cff5-7144-4825-97d5-af0149c333a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Chop", "[", 
   RowBox[{".0000000000000001", "+", 
    RowBox[{"2.00000012345678", "j"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.875261921051983*^9, 3.875261962638514*^9}, {
  3.8752619928776083`*^9, 3.875262029876906*^9}, {3.875262181656767*^9, 
  3.875262204589075*^9}, {3.8752622490320683`*^9, 3.87526227554256*^9}, {
  3.875262755628819*^9, 3.875262767632268*^9}, {3.875264404454813*^9, 
  3.8752644208029757`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"c62b7704-83b9-47b9-ae00-40fb589fbf2e"],

Cell[BoxData[
 RowBox[{"2.00000012345678`", " ", "j"}]], "Output",
 CellChangeTimes->{3.8752644455635643`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"4d1483c5-ec35-4087-a3fa-ce646853eb6e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"2.00000012345678`", " ", "j"}]], "Input",
 CellChangeTimes->{3.875264434017076*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"8f106fa8-0dee-45fe-be5b-42c092396ddb"],

Cell[BoxData[
 RowBox[{"2.00000012345678`", " ", "j"}]], "Output",
 CellChangeTimes->{3.875264434064219*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"f7e0ff6c-7621-410e-adf3-0ee3e038b740"]
},
WindowSize->{1209, 997},
WindowMargins->{{Automatic, -1513}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ea582c94-dd1a-465a-afd8-944ee47a6a9f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1698, 43, 210, "Input",ExpressionUUID->"b3c77ff3-8f48-4d9a-93a0-fd639b685f45"],
Cell[2259, 65, 2299, 52, 521, "Input",ExpressionUUID->"f4e80651-e929-4df1-91d8-77488f2cadc9"],
Cell[4561, 119, 15708, 361, 2561, "Input",ExpressionUUID->"9a12751b-a73a-43f1-990d-619b7ab9f0a3"],
Cell[20272, 482, 9490, 200, 1065, "Input",ExpressionUUID->"221d47f6-e111-43a9-b9f0-1ac9466c2440"],
Cell[29765, 684, 25630, 613, 4263, "Input",ExpressionUUID->"09e413ef-8fab-4ab4-937a-713ce585a74f"],
Cell[55398, 1299, 1634, 45, 283, "Input",ExpressionUUID->"5006cff5-7144-4825-97d5-af0149c333a1"],
Cell[CellGroupData[{
Cell[57057, 1348, 606, 10, 112, "Input",ExpressionUUID->"c62b7704-83b9-47b9-ae00-40fb589fbf2e"],
Cell[57666, 1360, 189, 3, 40, "Output",ExpressionUUID->"4d1483c5-ec35-4087-a3fa-ce646853eb6e"]
}, Open  ]],
Cell[57870, 1366, 186, 3, 36, "Input",ExpressionUUID->"8f106fa8-0dee-45fe-be5b-42c092396ddb"],
Cell[58059, 1371, 187, 3, 40, "Output",ExpressionUUID->"f7e0ff6c-7621-410e-adf3-0ee3e038b740"]
}
]
*)

